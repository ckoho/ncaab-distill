[
  {
    "path": "posts/2022-08-14-elo-rating-system/",
    "title": "ELO Rating System",
    "description": "Explanation of initial Elo ranking system for NCAA Men's Basketball.",
    "author": [
      {
        "name": "Colin Kohoutek",
        "url": {}
      }
    ],
    "date": "2022-08-14",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nElo Calculation\r\nExample Calculation\r\nPreseason Ratings\r\n\r\nChecking the Accuracy\r\nLog Loss\r\nBucketed Results\r\n\r\n\r\nIntroduction\r\nMy first pass at creating a rating system is using the ever common\r\nelo ranking system. You can find a lot about it online.\r\nEveryone starts at a 1500 rating and then the rating moves up (good) or\r\ndown based on results. Elo compares the ratings between two opponents\r\nand calculates the expected win percentage based on the delta between\r\nthe teams. For example one team with a rating of 1200 would have the\r\nsame expected win rate playing an opponent of 1100, as a team ranked\r\n1800 playing one with a rating 1700. After the completion of the game,\r\neach teams rating is adjusted. If a team is a heavy favorite, the\r\nadjustment is minor, but if an underdog wins the adjustment is large.\r\nThe winning team always gains rating points, and the losing teams go\r\ndown. Elo is a zero sum calculation, so the adjustment is the same (one\r\npositive and one negative) for both teams.\r\nElo Calculation\r\nThe calculation for a team winning a game is \\[ P_a= \\frac{1}{1 + 10 ^ \\frac{R_b - R_a}{400}}\r\n\\] In this equation \\(P_a\\) is\r\nthe probability of team a winning the game, \\(R_b\\) is the rating of team b and \\(R_a\\) is the rating of team a. If the game\r\nis at one team’s home court their rating is increased based on the home\r\ncourt advantage. This will be covered in a later post. The probability\r\nfor b just flips the \\(R_a\\) and \\(R_b\\) (or you can take \\(1 - P_a\\)). Once the game is complete each\r\nteam’s rating is adjusted based on the result. The adjustment equation\r\nis \\[ R_anew = R_a + K (O_a - P_a) \\]\r\n\\(R_anew\\) is the updated ranking for\r\nteam a. K is a constant that scales the adjustment. The larger K is the\r\nmore dependent the rankings are on the most recent results, and thus\r\nwould be more elastic. The goal is to chose a k that reflects team’s\r\nskill throughout the year, but does not cause wild swing in a team’s\r\nranking. I am going to use a k set to be 27. \\(O_a\\) is the outcome for team a. Since\r\nbasketball only has loss and wins, a win is 1 and a loss is 0. \\(P_a\\) is the probability of winning and\r\nthat equation is shown earlier in this example.\r\nExample Calculation\r\nHere I will run through an example to explain how the works. Say\r\nMontana (team A, rating: 1500) is playing Montana State (team B, rating:\r\n1600) on a neutral court. If one team was home their rating would be\r\nincreased by the home court advantage amount. Montana would have a win\r\nprobability, or expected outcome of \\(\\frac{1}{1 + 10 ^ \\frac{1600 - 1500}{400}} = .3599\r\n\\approx 36\\%\\) Not surprisingly inverting those rating give\r\nMontana State a probability of ~64%. Obviously, Montana State wins this\r\ngame, so it is time to adjust the rankings. Assuming k = 27, the\r\nadjustment is \\[R_anew = 1500 + 27 (0 -\r\n.3599) \\approx 1490.28\\] \\[R_bnew =\r\n1600 + 27 (1-.6401) \\approx 1609.72\\] Both teams ratings moved by\r\n9.72. If Montana had one the adjustment would have been 17.28 in the\r\nother direction for each team. There is a little more to the adjustment\r\nto make it more accurate, but that is covered in a later post.\r\nPreseason Ratings\r\nTo start the beginning of each year we have to adjust the end of\r\nseason ratings. Because we are not adjusting the rating based individual\r\nplayers, we don’t factor in graduation, transfers, new recruits, or\r\nexpected player development. For this simple system we just use the last\r\ntwo year’s ranking and a little regression to the mean. The current\r\nadjustment is taking 50% for the end of year ranking, 30% their previous\r\nyear ranking, and 20% 1500 (which is the mean).\r\nChecking the Accuracy\r\nI am using two measures to check the accuracy of my predictions and\r\nhelp choose the best k value. Those are log loss calculation and by\r\nbucketing the results by expected outcome.\r\nLog Loss\r\nLog loss is a calcuation that compares expected result to actual\r\nresult. It penalizes overconfidence. Without going into the gory details\r\n(more can be found here\r\nand here)\r\nif we said every game was a 50-50 coin flip the log loss would be .693,\r\nso we want to have a value lower than that to say our ranking is adding\r\nvalue. The plot below calculated log loss over multiple season on a\r\nrange of k values. It appears to be lowest in the 25-30 range.\r\n\r\n\r\n\r\n\r\n\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#fcqhqnuoft .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#fcqhqnuoft .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#fcqhqnuoft .gt_bottom_border {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_col_headings {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#fcqhqnuoft .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#fcqhqnuoft .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#fcqhqnuoft .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#fcqhqnuoft .gt_column_spanner {\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 5px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#fcqhqnuoft .gt_group_heading {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#fcqhqnuoft .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#fcqhqnuoft .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#fcqhqnuoft .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#fcqhqnuoft .gt_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#fcqhqnuoft .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#fcqhqnuoft .gt_stub_row_group {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  vertical-align: top;\r\n}\r\n\r\n#fcqhqnuoft .gt_row_group_first td {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#fcqhqnuoft .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#fcqhqnuoft .gt_first_summary_row {\r\n  border-top-style: solid;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_first_summary_row.thick {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#fcqhqnuoft .gt_last_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#fcqhqnuoft .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#fcqhqnuoft .gt_table_body {\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#fcqhqnuoft .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#fcqhqnuoft .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#fcqhqnuoft .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#fcqhqnuoft .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#fcqhqnuoft .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#fcqhqnuoft .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#fcqhqnuoft .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#fcqhqnuoft .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#fcqhqnuoft .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#fcqhqnuoft .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 75%;\r\n  vertical-align: 0.4em;\r\n}\r\n\r\n#fcqhqnuoft .gt_asterisk {\r\n  font-size: 100%;\r\n  vertical-align: 0;\r\n}\r\n\r\n#fcqhqnuoft .gt_indent_1 {\r\n  text-indent: 5px;\r\n}\r\n\r\n#fcqhqnuoft .gt_indent_2 {\r\n  text-indent: 10px;\r\n}\r\n\r\n#fcqhqnuoft .gt_indent_3 {\r\n  text-indent: 15px;\r\n}\r\n\r\n#fcqhqnuoft .gt_indent_4 {\r\n  text-indent: 20px;\r\n}\r\n\r\n#fcqhqnuoft .gt_indent_5 {\r\n  text-indent: 25px;\r\n}\r\nk\r\n      2009\r\n      2010\r\n      2011\r\n      2012\r\n      2013\r\n      2014\r\n    25\r\n0.53709\r\n0.52064\r\n0.52509\r\n0.51568\r\n0.53044\r\n0.5316726\r\n0.53677\r\n0.52036\r\n0.52497\r\n0.51536\r\n0.53057\r\n0.5318327\r\n0.53652\r\n0.52021\r\n0.52489\r\n0.51518\r\n0.53082\r\n0.5321328\r\n0.53635\r\n0.52008\r\n0.52502\r\n0.51507\r\n0.53112\r\n0.5324429\r\n0.53621\r\n0.51999\r\n0.52511\r\n0.51509\r\n0.53147\r\n0.5327930\r\n0.53613\r\n0.52009\r\n0.52533\r\n0.51505\r\n0.53192\r\n0.53321\r\n\r\nBucketed Results\r\nNow that we know our predicitions are better than a coin flip the\r\nnext thing is to confirm the results are roughly linear. If we say a\r\nteam has a ten percent chance of winning they should win roughly 10% of\r\nthose matchups. If each group wins as much as expected through the\r\nprobability it tells us the model is calibrated accurately.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-08-14-elo-rating-system/k_logloss.png",
    "last_modified": "2022-08-27T20:58:20-06:00",
    "input_file": "elo-rating-system.knit.md"
  },
  {
    "path": "posts/2022-04-01-introduction/",
    "title": "Introduction",
    "description": "Introduction to my plans",
    "author": [
      {
        "name": "Colin Kohoutek",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-04-01",
    "categories": [],
    "contents": "\r\nIntroduction\r\nHello. My name is Colin Kohoutek and this is my blog on NCAA basketball. I currently have ELO ratings for men’s and plan to add women and more advanced ratings systems. An ELO rating is a very common, simple method to rate opponents (https://en.wikipedia.org/wiki/Elo_rating_system). Basically you calculate the difference in rating between two teams to get an expected win percentage. A 100 point difference is a 64% win expectancy. Yuo then update the two ratings based on the outcome. The lower the expected win percentage the bigger rating boost if that team does win.\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-04-05T20:18:00-06:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to NCAA Basketball Distill",
    "description": "Welcome to my new blog, NCAA Basketball Distill. I will be blogging\nabout men's and women's basketball here.",
    "author": [
      {
        "name": "Colin Kohoutek",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-04-01",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-04-01T11:25:09-06:00",
    "input_file": {}
  }
]
